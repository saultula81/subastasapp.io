<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Plataforma de subastas en tiempo real - Puja y gana incre√≠bles art√≠culos">
    <meta name="theme-color" content="#1a1a2e">

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>SubastasApp - Subastas en Tiempo Real</title>

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Cargando SubastasApp...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Auth View -->
    <div id="auth-view" class="view active">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <h1 class="logo">üî® SubastasApp</h1>
                    <p class="tagline">Subastas en tiempo real</p>
                </div>

                <!-- Login Form -->
                <form id="login-form" class="auth-form">
                    <h2>Iniciar Sesi√≥n</h2>
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required placeholder="tu@email.com">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Contrase√±a</label>
                        <input type="password" id="login-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <button type="submit" class="btn btn-primary">Ingresar</button>
                    <p class="auth-switch">
                        ¬øNo tienes cuenta?
                        <a href="#" id="show-register">Reg√≠strate aqu√≠</a>
                    </p>
                </form>

                <!-- Register Form -->
                <form id="register-form" class="auth-form hidden">
                    <h2>Crear Cuenta</h2>
                    <div class="form-group">
                        <label for="register-name">Nombre</label>
                        <input type="text" id="register-name" required placeholder="Tu nombre">
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required placeholder="tu@email.com">
                    </div>
                    <div class="form-group">
                        <label for="register-password">Contrase√±a</label>
                        <input type="password" id="register-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6">
                    </div>
                    <button type="submit" class="btn btn-primary">Registrarse</button>
                    <p class="auth-switch">
                        ¬øYa tienes cuenta?
                        <a href="#" id="show-login">Inicia sesi√≥n aqu√≠</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- Main App View -->
    <div id="app-view" class="view">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <h1>üî® SubastasApp</h1>
                </div>
                <div class="nav-menu">
                    <button id="nav-auctions" class="nav-item active">
                        <span class="nav-icon">üèÜ</span>
                        <span>Subastas</span>
                    </button>
                    <button id="nav-my-bids" class="nav-item">
                        <span class="nav-icon">üí∞</span>
                        <span>Mis Pujas</span>
                    </button>
                    <button id="nav-admin" class="nav-item admin-only hidden">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>Admin</span>
                        <span id="notification-badge" class="notification-badge hidden">0</span>
                    </button>
                    <button id="nav-profile" class="nav-item">
                        <span class="nav-icon">üë§</span>
                        <span id="user-name-nav">Perfil</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Auctions View -->
        <main id="auctions-section" class="section active">
            <div class="container">
                <div class="section-header">
                    <h2>Subastas Activas</h2>
                    <button id="btn-create-auction" class="btn btn-primary admin-only hidden">
                        + Nueva Subasta
                    </button>
                </div>
                <div id="auctions-grid" class="auctions-grid">
                    <!-- Auctions will be loaded here -->
                </div>
            </div>
        </main>

        <!-- My Bids View -->
        <main id="my-bids-section" class="section">
            <div class="container">
                <h2>Mis Pujas Activas</h2>
                <div id="my-bids-list" class="bids-list">
                    <!-- User's bids will be loaded here -->
                </div>
            </div>
        </main>

        <!-- Admin Panel -->
        <main id="admin-section" class="section admin-only">
            <div class="container">
                <h2>Panel de Administraci√≥n</h2>

                <!-- Auction Requests -->
                <div class="admin-card">
                    <h3>Solicitudes de Subastas</h3>
                    <div id="auction-requests-list" class="requests-list">
                        <!-- Auction requests will be loaded here -->
                    </div>
                </div>

                <!-- All Auctions Management -->
                <div class="admin-card">
                    <h3>Todas las Subastas</h3>
                    <div id="admin-auctions-list" class="admin-auctions-list">
                        <!-- All auctions will be loaded here -->
                    </div>
                </div>
            </div>
        </main>

        <!-- Profile View -->
        <main id="profile-section" class="section">
            <div class="container">
                <div class="profile-card">
                    <h2>Mi Perfil</h2>
                    <div class="profile-info">
                        <p><strong>Nombre:</strong> <span id="profile-name"></span></p>
                        <p><strong>Email:</strong> <span id="profile-email"></span></p>
                        <p><strong>Rol:</strong> <span id="profile-role" class="role-badge"></span></p>
                    </div>

                    <!-- Request Auction Publication (for regular users) -->
                    <div id="auction-request-section" class="user-only hidden">
                        <h3>¬øQuieres publicar una subasta?</h3>
                        <p>Env√≠a una solicitud al administrador con los detalles de tu art√≠culo.</p>
                        <button id="btn-request-auction" class="btn btn-secondary">
                            üì§ Solicitar Publicar Subasta
                        </button>
                    </div>

                    <button id="btn-logout" class="btn btn-danger">Cerrar Sesi√≥n</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal: Create Auction (Admin Only) -->
    <div id="modal-create-auction" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Crear Nueva Subasta</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="form-create-auction">
                <div class="form-group">
                    <label for="auction-title">T√≠tulo</label>
                    <input type="text" id="auction-title" required placeholder="Ej: iPhone 15 Pro Max">
                </div>
                <label for="auction-duration">Duraci√≥n (horas)</label>
                <input type="number" id="auction-duration" required min="1" max="168" value="24" placeholder="24">
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
            <button type="submit" class="btn btn-primary">Crear Subasta</button>
        </div>
        </form>
    </div>
    </div>

    <!-- Modal: Place Bid -->
    <div id="modal-place-bid" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Realizar Puja</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div id="bid-modal-content">
                <p><strong>Art√≠culo:</strong> <span id="bid-auction-title"></span></p>
                <p><strong>Puja Actual:</strong> $<span id="bid-current-price"></span></p>
                <form id="form-place-bid">
                    <input type="hidden" id="bid-auction-id">
                    <div class="form-group">
                        <label for="bid-amount">Tu Puja ($)</label>
                        <input type="number" id="bid-amount" required min="1" step="0.01" placeholder="Ingresa tu puja">
                        <small>Debe ser mayor a la puja actual</small>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Confirmar Puja</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Request Auction Publication (Users) -->
    <div id="modal-request-auction" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Solicitar Publicar Subasta</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="form-request-auction">
                <div class="form-group">
                    <label for="request-title">T√≠tulo del Art√≠culo</label>
                    <input type="text" id="request-title" required placeholder="Ej: iPhone 15 Pro Max">
                </div>
                <div class="form-group">
                    <label for="request-description">Descripci√≥n</label>
                    <textarea id="request-description" required placeholder="Describe el art√≠culo en detalle..."
                        rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="request-image">Imagen del Art√≠culo</label>
                    <div class="image-upload-options">
                        <div class="upload-tabs">
                            <button type="button" class="upload-tab active" data-tab="file">
                                üìÅ Subir Archivo
                            </button>
                            <button type="button" class="upload-tab" data-tab="url">
                                üîó URL
                            </button>
                        </div>

                        <!-- File Upload Tab -->
                        <div id="upload-file-tab" class="upload-tab-content active">
                            <input type="file" id="request-image-file" accept="image/*" class="file-input">
                            <div class="upload-preview hidden">
                                <img class="preview-image" src="" alt="Preview">
                                <button type="button" class="btn-remove-image">‚úï</button>
                            </div>
                            <div class="upload-progress hidden">
                                <div class="progress-bar">
                                    <div class="progress-fill"></div>
                                </div>
                                <span class="progress-text">0%</span>
                            </div>
                            <small>M√°ximo 32MB. Gratis con ImgBB.</small>
                        </div>

                        <!-- URL Tab -->
                        <div id="upload-url-tab" class="upload-tab-content">
                            <input type="url" id="request-image-url" placeholder="https://ejemplo.com/imagen.jpg">
                            <small>O ingresa la URL de una imagen</small>
                        </div>
                        <!-- Hidden input to store final URL for form submission -->
                        <input type="hidden" id="request-image">
                    </div>
                </div>
                <div class="form-group">
                    <label for="request-price">Precio Inicial ($)</label>
                    <input type="number" id="request-price" required min="1" step="0.01" placeholder="100">
                </div>
                <div class="form-group">
                    <label for="request-duration">Duraci√≥n (horas)</label>
                    <input type="number" id="request-duration" required min="1" max="168" value="24" placeholder="24">
                </div>
                <div class="form-group">
                    <label for="request-phone">N√∫mero de Celular</label>
                    <input type="tel" id="request-phone" required placeholder="+54 9 11 1234-5678">
                    <small>Para que el admin pueda contactarte</small>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Enviar Solicitud</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <!-- App Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/auctions.js"></script>
    <script src="js/collaboration.js"></script>
    <script src="js/image-upload.js"></script>
    <script src="js/app.js"></script>
</body>

</html>